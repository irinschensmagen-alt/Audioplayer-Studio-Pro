<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Audio Player Studio PRO</title>

<style>
:root {
  --accent: #6cf;
  --bg: #0f0f14;
  --panel: rgba(255,255,255,0.08);
  --text: #ffffff;
  --font: 'Inter', system-ui, sans-serif;
}

[data-theme="light"] {
  --bg: #f4f6fb;
  --panel: rgba(0,0,0,0.05);
  --text: #111;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: var(--font);
  color: var(--text);
  background: linear-gradient(270deg, #ff0080, #7928ca, #2af598);
  background-size: 600% 600%;
  animation: chameleon 20s ease infinite;
}

@keyframes chameleon {
  0% {background-position: 0% 50%;}
  50% {background-position: 100% 50%;}
  100% {background-position: 0% 50%;}
}

.wrapper {
  display: grid;
  grid-template-columns: 340px 1fr;
  gap: 20px;
  padding: 20px;
}

.panel {
  background: var(--panel);
  backdrop-filter: blur(14px);
  border-radius: 18px;
  padding: 16px;
}

h2 { margin: 0 0 10px; font-size: 18px; }
label { font-size: 13px; opacity: .85; }
input, select, button, textarea {
  width: 100%;
  margin: 6px 0 14px;
}

button {
  background: var(--accent);
  color: #000;
  border: none;
  border-radius: 12px;
  padding: 10px;
  font-weight: 600;
  cursor: pointer;
}

.player-frame { display: flex; justify-content: center; align-items: center; }

.player {
  background: var(--bg);
  border-radius: 22px;
  padding: 16px;
  width: var(--w, 460px);
  height: var(--h, 320px);
  box-shadow: 0 20px 50px rgba(0,0,0,.5);
  display: grid;
  grid-template-rows: 1fr auto auto auto;
  gap: 12px;
}

.cover {
  width: 100%;
  height: 160px;
  background: #222 center/cover no-repeat;
  border-radius: 18px;
}

.controls {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.controls button { padding: 6px 12px; }

.timeline { width: 100%; }

.time { font-size: 12px; opacity: .7; text-align: right; }

.playlist {
  display: none;
  background: rgba(0,0,0,.3);
  border-radius: 14px;
  padding: 8px;
  max-height: 140px;
  overflow-y: auto;
}

.playlist div {
  padding: 6px;
  border-radius: 8px;
  cursor: pointer;
}

.playlist div:hover { background: rgba(255,255,255,.1); }
</style>
</head>

<body data-theme="dark">

<div class="wrapper">

<!-- PANEL -->
<div class="panel">
<h2>ğŸ› Audio Player Studio PRO</h2>

<label>ğŸŒ— Ğ¢ĞµĞ¼Ğ°</label>
<select id="theme">
  <option value="dark">Dark</option>
  <option value="light">Light</option>
</select>

<label>ğŸ¨ Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½ Ğ¿Ğ»ĞµĞµÑ€Ğ°</label>
<select id="template">
  <option value="classic">Classic</option>
  <option value="glass">Glass</option>
  <option value="minimal">Minimal</option>
</select>

<label>ğŸŒ Ğ¯Ğ·Ñ‹Ğº Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°</label>
<select id="lang"></select>

<label>ğŸ“ Ğ¨Ğ¸Ñ€Ğ¸Ğ½Ğ° (px)</label>
<input type="number" id="width" value="460">

<label>ğŸ“ Ğ’Ñ‹ÑĞ¾Ñ‚Ğ° (px)</label>
<input type="number" id="height" value="320">

<label>ğŸ¯ ĞĞºÑ†ĞµĞ½Ñ‚Ğ½Ñ‹Ğ¹ Ñ†Ğ²ĞµÑ‚</label>
<input type="color" id="color" value="#66ccff">

<label>ğŸ–¼ Ğ—Ğ°ÑÑ‚Ğ°Ğ²ĞºĞ°</label>
<input type="file" id="coverUpload" accept="image/*">

<label>ğŸµ Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ°ÑƒĞ´Ğ¸Ğ¾</label>
<input type="file" id="audioUpload" accept="audio/*" multiple>

<button onclick="generateIframe()">ğŸ“¦ ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ iframe</button>
<textarea id="iframe"></textarea>
</div>

<!-- PLAYER -->
<div class="player-frame">
<div class="player" id="player">
<div class="cover" id="cover"></div>

<div class="controls">
<button onclick="seek(-10)">âª 10s</button>
<button onclick="togglePlay()">â–¶ / â¸</button>
<button onclick="seek(10)">â© 10s</button>
<button onclick="togglePlaylist()">ğŸ“‚</button>
<button id="downloadBtn">â¬‡</button>
<button onclick="record()">ğŸ™</button>
</div>

<input class="timeline" type="range" min="0" value="0" step="0.01" onchange="audio.currentTime=this.value">
<div class="time" id="time">00:00 / 00:00</div>

<div class="panel" style="margin-top:8px">
<strong>ğŸš ĞœĞ¸ĞºÑˆĞµÑ€</strong>
<label>Ğ“Ñ€Ğ¾Ğ¼ĞºĞ¾ÑÑ‚ÑŒ</label>
<input type="range" min="0" max="1" step="0.01" value="1" onchange="audio.volume=this.value">
<label>ĞŸĞ°Ğ½Ğ¾Ñ€Ğ°Ğ¼Ğ° (Lâ€“R)</label>
<input type="range" min="-1" max="1" step="0.1" value="0" onchange="panNode.pan.value=this.value">
</div>

<div class="time" id="duration"></div>
<div class="time" id="time">00:00 / 00:00</div>
<div class="playlist" id="playlist"></div>
<audio id="audio"></audio>
</div>
</div>
</div>

<script>
const audio = document.getElementById('audio');
const ctx = new (window.AudioContext || window.webkitAudioContext)();
const source = ctx.createMediaElementSource(audio);
const panNode = ctx.createStereoPanner();
source.connect(panNode).connect(ctx.destination);
const timeline = document.querySelector('.timeline');
const playlistEl = document.getElementById('playlist');
const timeEl = document.getElementById('time');
const downloadBtn = document.getElementById('downloadBtn');
const player = document.getElementById('player');
let tracks = [];
let current = 0;
let recorder, chunks=[];

const langs = {
  ru:{play:'Play',list:'Playlist'},
  en:{play:'Play',list:'Playlist'},
  de:{play:'Abspielen',list:'Playlist'},
  fr:{play:'Lecture',list:'Playlist'},
  es:{play:'Reproducir',list:'Lista'},
  it:{play:'Riproduci',list:'Playlist'},
  zh:{play:'æ’­æ”¾',list:'æ’­æ”¾åˆ—è¡¨'},
  ar:{play:'ØªØ´ØºÙŠÙ„',list:'Ù‚Ø§Ø¦Ù…Ø©'},
  hi:{play:'à¤šà¤²à¤¾à¤à¤',list:'à¤¸à¥‚à¤šà¥€'}
};

Object.keys(langs).forEach(l=>{
  lang.innerHTML += `<option value="${l}">${l.toUpperCase()}</option>`;
});

function seek(sec){ audio.currentTime = Math.max(0, Math.min(audio.duration||0, audio.currentTime + sec)); }

function togglePlay(){ audio.paused ? audio.play() : audio.pause(); }
function togglePlaylist(){ playlistEl.style.display = playlistEl.style.display==='block'?'none':'block'; }

function format(t){ if(isNaN(t))return '00:00'; const m=Math.floor(t/60); const s=Math.floor(t%60); return `${m}:${s.toString().padStart(2,'0')}`; }

audio.ontimeupdate=()=>{
  timeline.max=audio.duration||0;
  timeline.value=audio.currentTime;
  timeEl.textContent = `${format(audio.currentTime)} / ${format(audio.duration)}`;
  if(audio.duration) duration.textContent = `â± Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ: ${format(audio.duration)}`;
};

function loadTrack(i){
  current=i; audio.src=tracks[i].url; audio.play();
  downloadBtn.onclick=()=>{const a=document.createElement('a');a.href=tracks[i].url;a.download=tracks[i].name;a.click();};
}

audioUpload.onchange=e=>{
  [...e.target.files].forEach(f=>{
    const url=URL.createObjectURL(f);
    tracks.push({name:f.name,url});
    const d=document.createElement('div'); d.textContent=f.name; d.onclick=()=>loadTrack(tracks.length-1);
    playlistEl.appendChild(d);
  }); if(tracks.length&&!audio.src)loadTrack(0);
};

coverUpload.onchange=e=>cover.style.backgroundImage=`url(${URL.createObjectURL(e.target.files[0])})`;

width.oninput=()=>player.style.setProperty('--w',width.value+'px');
height.oninput=()=>player.style.setProperty('--h',height.value+'px');
color.oninput=()=>document.documentElement.style.setProperty('--accent',color.value);

theme.onchange=()=>document.body.setAttribute('data-theme',theme.value);

template.onchange=()=>{
  if(template.value==='minimal') player.style.boxShadow='none';
  else if(template.value==='glass') player.style.background='rgba(255,255,255,.1)';
  else player.style.background='var(--bg)';
};

function generateIframe(){ iframe.value = `<iframe src="${location.href}" width="${width.value}" height="${height.value}" frameborder="0"></iframe>`; }

async function record(){
  if(!recorder){
    const stream=await navigator.mediaDevices.getUserMedia({audio:true});
    recorder=new MediaRecorder(stream);
    recorder.ondataavailable=e=>chunks.push(e.data);
    recorder.onstop=()=>{
      const blob=new Blob(chunks,{type:'audio/webm'}); chunks=[];
      const url=URL.createObjectURL(blob);
      tracks.push({name:'Recording',url});
      const d=document.createElement('div'); d.textContent='Recording'; d.onclick=()=>loadTrack(tracks.length-1);
      playlistEl.appendChild(d);
    };
    recorder.start();
  } else { recorder.stop(); recorder=null; }
}
</script>
</body>
</html>
