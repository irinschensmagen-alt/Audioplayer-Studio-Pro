<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Audio Player Studio PRO</title>

<style>
:root {
  --accent: #6cf;
  --bg: #0f0f14;
  --panel: rgba(255,255,255,0.08);
  --text: #ffffff;
  --font: 'Inter', system-ui, sans-serif;
}

[data-theme="light"] {
  --bg: #f4f6fb;
  --panel: rgba(0,0,0,0.05);
  --text: #111;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: var(--font);
  color: var(--text);
  background: linear-gradient(270deg, #ff0080, #7928ca, #2af598);
  background-size: 600% 600%;
  animation: chameleon 20s ease infinite;
}

@keyframes chameleon {
  0% {background-position: 0% 50%;}
  50% {background-position: 100% 50%;}
  100% {background-position: 0% 50%;}
}

.wrapper {
  display: grid;
  grid-template-columns: 340px 1fr;
  gap: 20px;
  padding: 20px;
}

.panel {
  background: var(--panel);
  backdrop-filter: blur(14px);
  border-radius: 18px;
  padding: 16px;
}

h2 { margin: 0 0 10px; font-size: 18px; }
label { font-size: 13px; opacity: .85; }
input, select, button, textarea {
  width: 100%;
  margin: 6px 0 14px;
}

button {
  background: var(--accent);
  color: #000;
  border: none;
  border-radius: 12px;
  padding: 10px;
  font-weight: 600;
  cursor: pointer;
}

.player-frame { display: flex; justify-content: center; align-items: center; }

.player {
  background: var(--bg);
  border-radius: 22px;
  padding: 16px;
  width: var(--w, 460px);
  height: var(--h, 320px);
  box-shadow: 0 20px 50px rgba(0,0,0,.5);
  display: grid;
  grid-template-rows: 1fr auto auto auto;
  gap: 12px;
}

.cover {
  width: 100%;
  height: 160px;
  background: #222 center/cover no-repeat;
  border-radius: 18px;
}

.controls {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.controls button { padding: 6px 12px; }

.timeline { width: 100%; }

.time { font-size: 12px; opacity: .7; text-align: right; }

.playlist {
  display: none;
  background: rgba(0,0,0,.3);
  border-radius: 14px;
  padding: 8px;
  max-height: 140px;
  overflow-y: auto;
}

.playlist div {
  padding: 6px;
  border-radius: 8px;
  cursor: pointer;
}

.playlist div:hover { background: rgba(255,255,255,.1); }
</style>
</head>

<body data-theme="dark">

<div class="wrapper">

<!-- PANEL -->
<div class="panel">
<h2>ğŸ› Audio Player Studio PRO</h2>
<div style="font-size:12px;opacity:.7;margin-bottom:10px">Ğ ĞµĞ¶Ğ¸Ğ¼ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°</div>
<select id="mode">
<option value="teacher">ğŸ“ ĞŸÑ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ</option>
<option value="student">ğŸ‘©â€ğŸ“ Ğ£Ñ‡ĞµĞ½Ğ¸Ğº</option>
</select>

<label>ğŸŒ— Ğ¢ĞµĞ¼Ğ°</label>
<select id="theme">
  <option value="dark">Dark</option>
  <option value="light">Light</option>
</select>

<label>ğŸ¨ Ğ¨Ğ°Ğ±Ğ»Ğ¾Ğ½ Ğ¿Ğ»ĞµĞµÑ€Ğ°</label>
<select id="template">
  <option value="classic">Classic</option>
  <option value="glass">Glass</option>
  <option value="minimal">Minimal</option>
</select>

<label>ğŸŒ Ğ¯Ğ·Ñ‹Ğº Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°</label>
<select id="lang"></select>

<label>ğŸ“ Ğ¨Ğ¸Ñ€Ğ¸Ğ½Ğ° (px)</label>
<input type="number" id="width" value="460">

<label>ğŸ“ Ğ’Ñ‹ÑĞ¾Ñ‚Ğ° (px)</label>
<input type="number" id="height" value="320">

<label>ğŸ¯ ĞĞºÑ†ĞµĞ½Ñ‚Ğ½Ñ‹Ğ¹ Ñ†Ğ²ĞµÑ‚</label>
<input type="color" id="color" value="#66ccff">

<label>ğŸ–¼ Ğ—Ğ°ÑÑ‚Ğ°Ğ²ĞºĞ°</label>
<input type="file" id="coverUpload" accept="image/*">

<label>ğŸµ Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ°ÑƒĞ´Ğ¸Ğ¾</label>
<input type="file" id="audioUpload" accept="audio/*" multiple>

<button onclick="generateIframe()">ğŸ“¦ ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ iframe</button>
<textarea id="iframe"></textarea>
</div>

<!-- PLAYER -->
<div class="player-frame" style="align-items:flex-start">
<div class="player" id="player" style="margin-top:0">
<div class="cover" id="cover"></div>

<div class="controls">
<button onclick="seek(-10)">âª 10s</button>
<button onclick="togglePlay()">â–¶ / â¸</button>
<button onclick="seek(10)">â© 10s</button>
<button onclick="togglePlaylist()">ğŸ“‚</button>
<button id="downloadBtn">â¬‡</button>
<button onclick="record()">ğŸ™</button>
</div>

<label style="font-size:12px;opacity:.7">â¯ ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµĞ´ĞµĞ½Ğ¸Ñ</label>
<input class="timeline" type="range" min="0" value="0" step="0.01" onchange="audio.currentTime=this.value">
<div class="time" id="time" style="text-align:left;font-weight:600">â± 00:00 / 00:00</div>

<div class="panel" style="margin-top:8px">
<div style="font-size:12px;opacity:.7;margin-bottom:4px">ğŸš ĞÑƒĞ´Ğ¸Ğ¾Ğ¼Ğ¸ĞºÑˆĞµÑ€</div>
<strong>ğŸš ĞœĞ¸ĞºÑˆĞµÑ€</strong>
<label>Ğ“Ñ€Ğ¾Ğ¼ĞºĞ¾ÑÑ‚ÑŒ</label>
<input type="range" min="0" max="1" step="0.01" value="1" onchange="audio.volume=this.value">
<label>ĞŸĞ°Ğ½Ğ¾Ñ€Ğ°Ğ¼Ğ° (Lâ€“R)</label>
<input type="range" min="-1" max="1" step="0.1" value="0" onchange="panNode.pan.value=this.value">
</div>

<div class="time" id="duration"></div>
<div class="time" id="time">00:00 / 00:00</div>
<div class="playlist" id="playlist"></div>
<audio id="audio"></audio>
</div>
</div>
</div>

<script>
const audio = document.getElementById('audio');
let ctx;
let source;
let panNode;

function initAudioContext(){
  if(ctx) return;
  ctx = new (window.AudioContext || window.webkitAudioContext)();
  source = ctx.createMediaElementSource(audio);
  panNode = ctx.createStereoPanner();
  source.connect(panNode).connect(ctx.destination);
}

audio.addEventListener('play', initAudioContext);
const source = ctx.createMediaElementSource(audio);
const panNode = ctx.createStereoPanner();
source.connect(panNode).connect(ctx.destination);
const timeline = document.querySelector('.timeline');
const playlistEl = document.getElementById('playlist');
const timeEl = document.getElementById('time');
const downloadBtn = document.getElementById('downloadBtn');
const player = document.getElementById('player');
let tracks = [];
let current = 0;
let recorder, chunks=[];

const langs = {
  ru:{player:'ĞŸĞ»ĞµĞµÑ€',mixer:'ĞœĞ¸ĞºÑˆĞµÑ€',playlist:'ĞŸĞ»ĞµĞ¹Ğ»Ğ¸ÑÑ‚',position:'ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµĞ´ĞµĞ½Ğ¸Ñ',volume:'Ğ“Ñ€Ğ¾Ğ¼ĞºĞ¾ÑÑ‚ÑŒ',pan:'ĞŸĞ°Ğ½Ğ¾Ñ€Ğ°Ğ¼Ğ°',modeTeacher:'ĞŸÑ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ',modeStudent:'Ğ£Ñ‡ĞµĞ½Ğ¸Ğº'},
  en:{player:'Player',mixer:'Mixer',playlist:'Playlist',position:'Playback position',volume:'Volume',pan:'Pan',modeTeacher:'Teacher',modeStudent:'Student'},
  de:{player:'Player',mixer:'Mixer',playlist:'Playlist',position:'Wiedergabeposition',volume:'LautstÃ¤rke',pan:'Panorama',modeTeacher:'Lehrer',modeStudent:'SchÃ¼ler'},
  fr:{player:'Lecteur',mixer:'Mixeur',playlist:'Playlist',position:'Position de lecture',volume:'Volume',pan:'Panoramique',modeTeacher:'Professeur',modeStudent:'Ã‰tudiant'},
  es:{player:'Reproductor',mixer:'Mezclador',playlist:'Lista',position:'PosiciÃ³n',volume:'Volumen',pan:'Panorama',modeTeacher:'Profesor',modeStudent:'Estudiante'},
  it:{player:'Lettore',mixer:'Mixer',playlist:'Playlist',position:'Posizione',volume:'Volume',pan:'Panoramica',modeTeacher:'Docente',modeStudent:'Studente'},
  zh:{player:'æ’­æ”¾å™¨',mixer:'æ··éŸ³å™¨',playlist:'æ’­æ”¾åˆ—è¡¨',position:'æ’­æ”¾ä½ç½®',volume:'éŸ³é‡',pan:'å£°åƒ',modeTeacher:'æ•™å¸ˆ',modeStudent:'å­¦ç”Ÿ'},
  ar:{player:'Ù…Ø´ØºÙ„',mixer:'Ø®Ù„Ø§Ø·',playlist:'Ù‚Ø§Ø¦Ù…Ø©',position:'Ù…ÙˆØ¶Ø¹ Ø§Ù„ØªØ´ØºÙŠÙ„',volume:'Ø§Ù„ØµÙˆØª',pan:'ØªÙˆØ§Ø²Ù†',modeTeacher:'Ù…Ø¹Ù„Ù…',modeStudent:'Ø·Ø§Ù„Ø¨'},
  hi:{player:'à¤ªà¥à¤²à¥‡à¤¯à¤°',mixer:'à¤®à¤¿à¤•à¥à¤¸à¤°',playlist:'à¤¸à¥‚à¤šà¥€',position:'à¤ªà¥à¤²à¥‡ à¤¸à¥à¤¥à¤¿à¤¤à¤¿',volume:'à¤†à¤µà¤¾à¤œà¤¼',pan:'à¤ªà¥ˆà¤¨',modeTeacher:'à¤¶à¤¿à¤•à¥à¤·à¤•',modeStudent:'à¤›à¤¾à¤¤à¥à¤°'}
};

Object.keys(langs).forEach(l=>{
  const opt=document.createElement('option');
  opt.value=l; opt.textContent=l.toUpperCase();
  lang.appendChild(opt);
});

lang.onchange=()=>applyLang(lang.value);

function applyLang(l){
  document.querySelector('[data-i18n="player"]').textContent = langs[l].player;
  document.querySelector('[data-i18n="mixer"]').textContent = langs[l].mixer;
  document.querySelector('[data-i18n="playlist"]').textContent = langs[l].playlist;
  document.querySelector('[data-i18n="position"]').textContent = langs[l].position;
  document.querySelector('[data-i18n="volume"]').textContent = langs[l].volume;
  document.querySelector('[data-i18n="pan"]').textContent = langs[l].pan;
  mode.options[0].textContent = 'ğŸ“ ' + langs[l].modeTeacher;
  mode.options[1].textContent = 'ğŸ‘©â€ğŸ“ ' + langs[l].modeStudent;
}

applyLang('ru');

function seek(sec){ audio.currentTime = Math.max(0, Math.min(audio.duration||0, audio.currentTime + sec)); }

function togglePlay(){
  initAudioContext();
  audio.paused ? audio.play() : audio.pause();
}

function seek(){ audio.paused ? audio.play() : audio.pause(); }
function togglePlaylist(){ playlistEl.style.display = playlistEl.style.display==='block'?'none':'block'; }

function format(t){ if(isNaN(t))return '00:00'; const m=Math.floor(t/60); const s=Math.floor(t%60); return `${m}:${s.toString().padStart(2,'0')}`; }

audio.ontimeupdate=()=>{
  timeline.max=audio.duration||0;
  timeline.value=audio.currentTime;
  timeEl.textContent = `${format(audio.currentTime)} / ${format(audio.duration)}`;
  if(audio.duration) duration.textContent = `â± Ğ”Ğ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ: ${format(audio.duration)}`;
};

function loadTrack(i){
  current=i; audio.src=tracks[i].url; audio.play();
  downloadBtn.onclick=()=>{const a=document.createElement('a');a.href=tracks[i].url;a.download=tracks[i].name;a.click();};
}

audioUpload.onchange=e=>{
  [...e.target.files].forEach(f=>{
    const url=URL.createObjectURL(f);
    tracks.push({name:f.name,url});
    const d=document.createElement('div'); d.textContent=f.name; d.onclick=()=>loadTrack(tracks.length-1);
    playlistEl.appendChild(d);
  }); if(tracks.length&&!audio.src)loadTrack(0);
};

coverUpload.onchange=e=>cover.style.backgroundImage=`url(${URL.createObjectURL(e.target.files[0])})`;

width.oninput=()=>player.style.setProperty('--w',width.value+'px');
height.oninput=()=>player.style.setProperty('--h',height.value+'px');
color.oninput=()=>document.documentElement.style.setProperty('--accent',color.value);

theme.onchange=()=>document.body.setAttribute('data-theme',theme.value);

template.onchange=()=>{
  if(template.value==='minimal') player.style.boxShadow='none';
  else if(template.value==='glass') player.style.background='rgba(255,255,255,.1)';
  else player.style.background='var(--bg)';
};

function generateIframe(){ iframe.value = `<iframe src="${location.href}" width="${width.value}" height="${height.value}" frameborder="0"></iframe>`; }

async function record(){
  if(!recorder){
    const stream=await navigator.mediaDevices.getUserMedia({audio:true});
    recorder=new MediaRecorder(stream);
    recorder.ondataavailable=e=>chunks.push(e.data);
    recorder.onstop=()=>{
      const blob=new Blob(chunks,{type:'audio/webm'}); chunks=[];
      const url=URL.createObjectURL(blob);
      tracks.push({name:'Recording',url});
      const d=document.createElement('div'); d.textContent='Recording'; d.onclick=()=>loadTrack(tracks.length-1);
      playlistEl.appendChild(d);
    };
    recorder.start();
  } else { recorder.stop(); recorder=null; }
}
</script>
</body>
</html>
