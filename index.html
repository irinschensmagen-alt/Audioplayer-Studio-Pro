<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deutsch interaktiv Studio PRO</title>
    <style>
        :root { --primary: #6c5ce7; --bg-grad: linear-gradient(-45deg, #0f2027, #203a43, #2c5364); }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; min-height: 100vh; background: var(--bg-grad); display: flex; justify-content: center; overflow-x: hidden; }
        .container { display: grid; grid-template-columns: 1fr 1.5fr; gap: 10px; width: 100%; height: 100vh; padding: 10px; box-sizing: border-box; }
        .panel { background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(10px); padding: 15px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); display: flex; flex-direction: column; overflow-y: auto; position: relative; }
        .header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; border-bottom: 2px solid var(--primary); padding-bottom: 5px; }
        .logo { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--primary); background: white; object-fit: contain; }
        .cover-art { width: 100%; height: 220px; border-radius: 15px; background: #dfe6e9; border: 3px solid #fff; display: flex; flex-direction: column; justify-content: center; align-items: center; background-size: cover; background-position: center; position: relative; }
        .cover-art::before { content: "üéµ"; font-size: 50px; opacity: 0.2; }
        .cover-art.has-img::before { display: none; }
        label { display: block; font-size: 0.65rem; font-weight: bold; margin: 8px 0 3px; text-transform: uppercase; color: #636e72; }
        select, input, textarea { width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #ddd; margin-bottom: 5px; box-sizing: border-box; font-size: 0.8rem; }
        .btn { width: 100%; min-height: 40px; border: none; border-radius: 10px; background: var(--primary); color: white; cursor: pointer; font-weight: bold; transition: 0.2s; margin-top: 5px; font-size: 0.9rem; }
        .controls { display: flex; justify-content: center; gap: 12px; margin: 10px 0; }
        .c-btn { width: 45px; height: 45px; border-radius: 12px; border: none; background: var(--primary); color: white; font-size: 1.1rem; cursor: pointer; }
        #play { width: 60px; height: 60px; border-radius: 50%; font-size: 1.6rem; }
        #test-counter { font-size: 0.9rem; font-weight: bold; color: #e74c3c; text-align: center; margin-bottom: 5px; display: none; }
        #lock-screen { position: absolute; inset: 0; background: rgba(0,0,0,0.95); z-index: 2000; border-radius: 20px; display: none; flex-direction: column; justify-content: center; align-items: center; color: white; text-align: center; padding: 20px; }
        @media (max-width: 768px) { .container { grid-template-columns: 1fr; height: auto; } }
    </style>
</head>
<body>

<div id="lock-screen">
    <h1 id="lock-msg">Time is up / –ü–æ–ø—ã—Ç–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω—ã</h1>
    <p id="lock-sub">–í—ã –ø—Ä–æ—Å–ª—É—à–∞–ª–∏ –∞—É–¥–∏–æ 2 —Ä–∞–∑–∞. –≠–∫–∑–∞–º–µ–Ω –∑–∞–≤–µ—Ä—à–µ–Ω.</p>
    <button class="btn" onclick="location.reload()" style="width:140px; background:#e74c3c">Restart</button>
</div>

<div class="container">
    <div class="panel">
        <div class="header">
            <img src="logo.png" class="logo" alt="Logo" onerror="this.src='https://via.placeholder.com/60?text=DI'">
            <h3 id="app-title" style="margin:0; font-size: 1rem;">Audio Studio</h3>
        </div>
        <label id="lbl-lang">–Ø–∑—ã–∫ / Sprache</label>
        <select id="langSet">
            <option value="ru">–†—É—Å—Å–∫–∏–π</option><option value="de">Deutsch</option><option value="en">English</option>
            <option value="fr">Fran√ßais</option><option value="it">Italiano</option><option value="es">Espa√±ol</option>
            <option value="pl">Polski</option>
        </select>
        <label id="lbl-mode">–†–µ–∂–∏–º / Modus</label>
        <select id="modeSet">
            <option value="master">Master (Loop)</option>
            <option value="study">Study (0.8x Slow)</option>
            <option value="test">Test (2 Attempts)</option>
        </select>
        <button class="btn" id="slowBtn" style="background:#00b894; display:none">üê¢ Slow 0.8x</button>
        <button class="btn" id="loopBtn" style="background:#0984e3; display:none">üîÑ Loop: Off</button>
        <label id="lbl-code">–ö–æ–¥ Iframe</label>
        <textarea id="ifOut" readonly style="height:35px;"></textarea>
        <button class="btn" id="copyBtn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
    </div>

    <div class="panel">
        <div id="cur-mode-tag" style="font-weight:bold; color:var(--primary); font-size:0.65rem; margin-bottom:5px;">MASTER MODE</div>
        <div class="cover-art" id="cover"><div id="hint-text" style="font-size:0.65rem; color:#636e72;">–û–±–ª–æ–∂–∫–∞</div></div>
        
        <div id="test-counter">–ü–æ–ø—ã—Ç–∫–∞: 1 / 2</div>
        
        <input type="range" id="prog" value="0" step="0.1" style="width:100%; accent-color: var(--primary);">
        <div id="time-txt" style="text-align:center; font-weight:bold; font-family: monospace; font-size: 0.8rem;">00:00 / 00:00</div>
        
        <div class="controls">
            <button class="c-btn" id="rew">‚è™</button>
            <button class="c-btn" id="play">‚ñ∂</button>
            <button class="c-btn" id="fwd">‚è©</button>
        </div>
        
        <label id="lbl-url">üîó –°—Å—ã–ª–∫–∞ –Ω–∞ –ê—É–¥–∏–æ (URL)</label>
        <input type="text" id="audUrl" placeholder="https://site.com/track.mp3">
        <label id="lbl-img-url">üîó –°—Å—ã–ª–∫–∞ –Ω–∞ –û–±–ª–æ–∂–∫—É (URL)</label>
        <input type="text" id="imgUrl" placeholder="https://site.com/image.jpg">
        <label id="lbl-audio">üìÅ –ò–ª–∏ —Ñ–∞–π–ª</label>
        <input type="file" id="audIn" accept="audio/*">
        <label id="lbl-img">üñºÔ∏è –ò–ª–∏ —Ñ–∞–π–ª –æ–±–ª–æ–∂–∫–∏</label>
        <input type="file" id="imgIn" accept="image/*">
    </div>
</div>

<script>
    const audio = new Audio(); audio.preservesPitch = true;
    let testAttempts = 0; 
    let studyPlayCount = 0;

    const dict = {
        ru: { title: "–ê—É–¥–∏–æ –°—Ç—É–¥–∏—è", lang: "üåê –Ø–∑—ã–∫", mode: "üéì –†–µ–∂–∏–º", code: "üì¶ –ö–æ–¥ Iframe", audio: "üìÅ –§–∞–π–ª", img: "üñºÔ∏è –§–∞–π–ª –æ–±–ª–æ–∂–∫–∏", url: "üîó –°—Å—ã–ª–∫–∞ –Ω–∞ –∞—É–¥–∏–æ", imgUrl: "üîó –°—Å—ã–ª–∫–∞ –Ω–∞ –æ–±–ª–æ–∂–∫—É", copy: "–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥", lock: "–í—Ä–µ–º—è –≤—ã—à–ª–æ!", slow: "üê¢ –ó–∞–º–µ–¥–ª–∏—Ç—å 0.8x", hint: "–û–±–ª–æ–∂–∫–∞", attempt: "–ü–æ–ø—ã—Ç–∫–∞" },
        de: { title: "Audio Studio", lang: "üåê Sprache", mode: "üéì Modus", code: "üì¶ Iframe-Code", audio: "üìÅ Datei", img: "üñºÔ∏è Cover-Datei", url: "üîó Audio-Link", imgUrl: "üîó Cover-Link", copy: "Code kopieren", lock: "Zeit um!", slow: "üê¢ Langsam 0.8x", hint: "Cover", attempt: "Versuch" },
        en: { title: "Audio Studio", lang: "üåê Language", mode: "üéì Mode", code: "üì¶ Iframe Code", audio: "üìÅ File", img: "üñºÔ∏è Cover File", url: "üîó Audio URL", imgUrl: "üîó Cover URL", copy: "Copy Code", lock: "Time is up!", slow: "üê¢ Slow 0.8x", hint: "Cover", attempt: "Attempt" }
    };

    function updateUI() {
        const d = dict[document.getElementById('langSet').value] || dict['en'];
        document.getElementById('app-title').innerText = d.title;
        document.getElementById('lbl-lang').innerText = d.lang;
        document.getElementById('lbl-mode').innerText = d.mode;
        document.getElementById('lbl-url').innerText = d.url;
        document.getElementById('lbl-img-url').innerText = d.imgUrl;
        document.getElementById('lbl-audio').innerText = d.audio;
        document.getElementById('lbl-img').innerText = d.img;
        document.getElementById('copyBtn').innerText = d.copy;
        document.getElementById('hint-text').innerText = d.hint;
        updateTestCounter();
    }

    function updateTestCounter() {
        const d = dict[document.getElementById('langSet').value] || dict['en'];
        document.getElementById('test-counter').innerText = `${d.attempt}: ${testAttempts + 1} / 2`;
    }

    document.getElementById('langSet').onchange = updateUI;
    
    document.getElementById('modeSet').onchange = function() {
        const m = this.value; 
        document.getElementById('cur-mode-tag').innerText = m.toUpperCase() + " MODE";
        document.getElementById('slowBtn').style.display = (m==='study')?'block':'none';
        document.getElementById('loopBtn').style.display = (m==='master')?'block':'none';
        document.getElementById('test-counter').style.display = (m==='test')?'block':'none';
        
        testAttempts = 0; studyPlayCount = 0;
        audio.playbackRate = 1; audio.loop = false;
        document.getElementById('prog').disabled = false;
        document.getElementById('rew').disabled = false;
        document.getElementById('fwd').disabled = false;
        updateTestCounter();
    };

    document.getElementById('audUrl').oninput = function() { if(this.value) audio.src = this.value; };
    document.getElementById('audIn').onchange = (e) => audio.src = URL.createObjectURL(e.target.files[0]);
    
    document.getElementById('imgUrl').oninput = function() {
        if(this.value) {
            const cov = document.getElementById('cover');
            cov.style.backgroundImage = `url(${this.value})`;
            cov.classList.add('has-img');
            document.getElementById('hint-text').style.display = 'none';
        }
    };

    document.getElementById('play').onclick = () => {
        if(!audio.src) return alert("–î–æ–±–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –∏–ª–∏ —Ñ–∞–π–ª!");
        const m = document.getElementById('modeSet').value;

        if(audio.paused) {
            if(m === 'test') {
                document.getElementById('prog').disabled = true;
                document.getElementById('rew').disabled = true;
                document.getElementById('fwd').disabled = true;
            }
            audio.play(); 
            document.getElementById('play').innerText = '‚è∏';
        } else {
            audio.pause(); 
            document.getElementById('play').innerText = '‚ñ∂';
        }
    };

    audio.onended = () => {
        const m = document.getElementById('modeSet').value;
        document.getElementById('play').innerText = '‚ñ∂';
        
        if(m === 'test') {
            testAttempts++;
            updateTestCounter();
            if(testAttempts >= 2) {
                document.getElementById('lock-screen').style.display = 'flex';
            }
        }
        if(m === 'study') {
            studyPlayCount++;
            if(studyPlayCount >= 3) {
                document.getElementById('prog').disabled = true;
                document.getElementById('rew').disabled = true;
                document.getElementById('fwd').disabled = true;
            }
        }
    };

    document.getElementById('slowBtn').onclick = function() {
        audio.playbackRate = (audio.playbackRate === 1) ? 0.8 : 1;
        this.style.background = (audio.playbackRate === 0.8) ? "#e67e22" : "#00b894";
    };

    document.getElementById('loopBtn').onclick = function() {
        audio.loop = !audio.loop;
        this.innerText = audio.loop ? "üîÑ Loop: ON" : "üîÑ Loop: OFF";
    };

    audio.ontimeupdate = () => {
        const p = document.getElementById('prog'); p.max = audio.duration || 0; p.value = audio.currentTime;
        const f = s => new Date(s * 1000).toISOString().substr(14, 5);
        document.getElementById('time-txt').innerText = `${f(audio.currentTime)} / ${f(audio.duration || 0)}`;
    };

    document.getElementById('prog').oninput = (e) => audio.currentTime = e.target.value;
    document.getElementById('rew').onclick = () => audio.currentTime -= 10;
    document.getElementById('fwd').onclick = () => audio.currentTime += 10;
    
    document.getElementById('copyBtn').onclick = () => {
        const code = `<iframe src="${window.location.href}" width="100%" height="600px" frameborder="0" scrolling="no"></iframe>`;
        document.getElementById('ifOut').value = code; navigator.clipboard.writeText(code); alert("–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!");
    };
    updateUI();
</script>
</body>
</html>
